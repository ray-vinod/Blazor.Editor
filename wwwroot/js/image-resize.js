!function (t, e) { "object" == typeof exports && "undefined" != typeof module ? module.exports = e() : "function" == typeof define && define.amd ? define(e) : (t = t || self).ImageResize = e() }(this, function () { "use strict"; var t = function (e, i) { return (t = Object.setPrototypeOf || ({ __proto__: [] }) instanceof Array && function (t, e) { t.__proto__ = e } || function (t, e) { for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]) })(e, i) }, e = function () { return (e = Object.assign || function t(e) { for (var i, r = 1, s = arguments.length; r < s; r++)for (var o in i = arguments[r]) Object.prototype.hasOwnProperty.call(i, o) && (e[o] = i[o]); return e }).apply(this, arguments) }; !function t(e) { if (e && "undefined" != typeof window) { var i = document.createElement("style"); return i.setAttribute("media", "screen"), i.innerHTML = e, document.head.appendChild(i), e } }("#editor-resizer .handler,#editor-resizer .handler-top-left{width:10px;height:10px;background-color:rgba(0,0,0,.5);cursor:nwse-resize;user-select:none}#editor-resizer,#editor-resizer .handler,#editor-resizer .handler-top-left,#editor-resizer .toolbar{border:1px solid #333;position:absolute}#editor-resizer{background-color:rgba(255,255,255,.8);box-shadow:0 0 5px rgba(0,0,0,.3)}#editor-resizer .handler{right:-5px;bottom:-5px}#editor-resizer .handler-top-left{left:-5px;top:-5px}#editor-resizer .toolbar{top:50%;left:50%;transform:translate(-50%,-50%);padding:.5em .25em;border-radius:5px;background-color:rgba(0,0,0,.9);color:#fff;box-shadow:0 0 10px rgba(0,0,0,.5);width:18em}#editor-resizer .toolbar .group{display:flex;border:1px solid #bbb;border-radius:6px;overflow:hidden}#editor-resizer .toolbar .group:not(:last-child){margin-bottom:.5em}#editor-resizer .toolbar .group .btn{flex:1;padding:.2rem 0;font-size:12px;text-align:center;user-select:none;color:#fff;background-color:rgba(255,255,255,.1);position:relative;box-sizing:border-box;z-index:1;cursor:pointer}#editor-resizer .toolbar .group .btn:not(:last-child){border-right:1px solid #bbb;border-radius:0}#editor-resizer .toolbar .group .btn:active{background-color:rgba(255,255,255,.2)}#editor-resizer .toolbar .group .input-wrapper{width:25%;border-right:1px solid #bbb;position:relative}#editor-resizer .toolbar .group .input-wrapper input{color:#fff;background-color:rgba(0,0,0,.3);text-align:center;width:100%;border:none;outline:0;padding:.25em .5em}#editor-resizer .toolbar .group .input-wrapper .suffix{position:absolute;right:.5em;color:#fff}"); var i, r = function () { function t(t) { this.config = e(e({}, s), t) } return t.prototype.findLabel = function (t) { return this.config ? Reflect.get(this.config, t) : null }, t }(), s = { floatLeft: "left", floatRight: "right", center: "center", restore: "restore", altTip: "Press and hold alt to lock ratio!", inputTip: "Press enter key to apply change!" }; i = HTMLElement, !function e(i, r) { function s() { this.constructor = i } t(i, r), i.prototype = null === r ? Object.create(r) : (s.prototype = r.prototype, new s) }(function t() { var e = null !== i && i.apply(this, arguments) || this; return e.originSize = null, e }, i); var o = function () { function t(t, e, i) { this.resizer = null, this.startResizePosition = null, this.i18n = new r((null == i ? void 0 : i.locale) || s), this.options = i, this.resizeTarget = t, t.originSize || (t.originSize = { width: t.clientWidth, height: t.clientHeight }), this.container = e, this.initResizer(), this.positionResizerToTarget(t), this.resizing = this.resizing.bind(this), this.endResize = this.endResize.bind(this), this.startResize = this.startResize.bind(this), this.toolbarClick = this.toolbarClick.bind(this), this.toolbarInputChange = this.toolbarInputChange.bind(this), this.bindEvents() } return t.prototype.initResizer = function () { var t = this.container.querySelector("#editor-resizer"); if (!t) { (t = document.createElement("div")).setAttribute("id", "editor-resizer"), t.innerHTML = function t(e) { for (var i = [], r = 1; r < arguments.length; r++)i[r - 1] = arguments[r]; return e.replace(/\{(\d+)\}/g, function (t, e) { return i.length > e ? i[e] : "" }) }('<div class=handler title={0}></div><div class=toolbar><div class=group><a class=btn data-styles=width:100% data-type=width>100%</a> <a class=btn data-styles=width:50% data-type=width>50%</a> <span class=input-wrapper><input data-type=width maxlength=3> <span class=suffix>%</span> <span class=tooltip>Press enter key to apply change!</span> </span><a class=btn data-styles=width:auto data-type=width>{4}</a></div><div class=group><a class=btn data-styles=float:left data-type=align>{1}</a> <a class=btn data-styles=display:block;margin:auto; data-type=align>{2}</a> <a class=btn data-styles=float:right; data-type=align>{3}</a> <a class=btn data-styles=""data-type=align>{4}</a></div></div>', this.i18n.findLabel("altTip"), this.i18n.findLabel("floatLeft"), this.i18n.findLabel("center"), this.i18n.findLabel("floatRight"), this.i18n.findLabel("restore"), this.i18n.findLabel("inputTip")); var e = document.createElement("div"); e.className = "handler handler-top-left", t.appendChild(e), this.container.appendChild(t) } this.resizer = t }, t.prototype.positionResizerToTarget = function (t) { null !== this.resizer && (this.resizer.style.setProperty("left", t.offsetLeft + "px"), this.resizer.style.setProperty("top", t.offsetTop + "px"), this.resizer.style.setProperty("width", t.clientWidth + "px"), this.resizer.style.setProperty("height", t.clientHeight + "px")) }, t.prototype.bindEvents = function () { null !== this.resizer && (this.resizer.addEventListener("mousedown", this.startResize), this.resizer.addEventListener("click", this.toolbarClick), this.resizer.addEventListener("change", this.toolbarInputChange)), window.addEventListener("mouseup", this.endResize), window.addEventListener("mousemove", this.resizing) }, t.prototype._setStylesForToolbar = function (t, e) { var i, r = "_styles_" + t, s = this.resizeTarget.style, o = this.resizeTarget[r]; s.cssText = s.cssText.replaceAll(" ", "").replace(o, "") + ";" + e, this.resizeTarget[r] = e, this.positionResizerToTarget(this.resizeTarget), null === (i = this.options) || void 0 === i || i.onChange(this.resizeTarget) }, t.prototype.toolbarInputChange = function (t) { var e, i = t.target, r = null === (e = null == i ? void 0 : i.dataset) || void 0 === e ? void 0 : e.type, s = i.value; r && Number(s) && this._setStylesForToolbar(r, "width: " + Number(s) + "%;") }, t.prototype.toolbarClick = function (t) { var e, i, r = t.target, s = null === (e = null == r ? void 0 : r.dataset) || void 0 === e ? void 0 : e.type; s && r.classList.contains("btn") && this._setStylesForToolbar(s, null === (i = null == r ? void 0 : r.dataset) || void 0 === i ? void 0 : i.styles) }, t.prototype.startResize = function (t) { var e = t.target; e.classList.contains("handler") && 1 === t.which && (this.startResizePosition = { left: t.clientX, top: t.clientY, width: this.resizeTarget.clientWidth, height: this.resizeTarget.clientHeight }, this.isTopLeft = e.classList.contains("handler-top-left")) }, t.prototype.endResize = function () { var t; this.startResizePosition = null, null === (t = this.options) || void 0 === t || t.onChange(this.resizeTarget) }, t.prototype.resizing = function (t) { if (this.startResizePosition) { var e = t.clientX - this.startResizePosition.left, i = t.clientY - this.startResizePosition.top, r = this.startResizePosition.width, s = this.startResizePosition.height; if (this.isTopLeft ? (r -= e, s -= i, this.resizeTarget.style.setProperty("left", this.resizeTarget.offsetLeft + e + "px"), this.resizeTarget.style.setProperty("top", this.resizeTarget.offsetTop + i + "px")) : (r += e, s += i), t.altKey) { var o = this.resizeTarget.originSize; s = o.height / o.width * r } this.resizeTarget.style.setProperty("width", Math.max(r, 30) + "px"), this.resizeTarget.style.setProperty("height", Math.max(s, 30) + "px"), this.positionResizerToTarget(this.resizeTarget) } }, t.prototype.destory = function () { this.container.removeChild(this.resizer), window.removeEventListener("mouseup", this.endResize), window.removeEventListener("mousemove", this.resizing), this.resizer = null }, t }(), n = function t(e, i) { this.element = e, this.cb = i, this.hasTracked = !1 }, a = function () { function t() { } return t.track = function (e, i) { this.iframes.push(new n(e, i)), this.interval || (this.interval = setInterval(function () { t.checkClick() }, this.resolution)) }, t.checkClick = function () { if (document.activeElement) { var t = document.activeElement; for (var e in this.iframes) t === this.iframes[e].element ? !1 == this.iframes[e].hasTracked && (this.iframes[e].cb.apply(window, []), this.iframes[e].hasTracked = !0) : this.iframes[e].hasTracked = !1 } }, t.resolution = 200, t.iframes = [], t.interval = null, t }(); return function t(i, r) { var s, n, l = i.root; function h() { var t = new (i.getContents()).constructor().retain(1); i.updateContents(t) } l.addEventListener("click", function (t) { var i = t.target; t.target && ["img", "video"].includes(i.tagName.toLowerCase()) && (s = i, n = new o(i, l.parentElement, e(e({}, r), { onChange: h }))) }), i.on("text-change", function (t, i) { l.querySelectorAll("iframe").forEach(function (t) { a.track(t, function () { s = t, n = new o(t, l.parentElement, e(e({}, r), { onChange: h })) }) }) }), document.addEventListener("mousedown", function (t) { var e, i, r, o = t.target; o === s || (null === (i = null === (e = null == n ? void 0 : n.resizer) || void 0 === e ? void 0 : e.contains) || void 0 === i ? void 0 : i.call(e, o)) || (null === (r = null == n ? void 0 : n.destory) || void 0 === r || r.call(n), n = null, s = null) }, { capture: !0 }) } });